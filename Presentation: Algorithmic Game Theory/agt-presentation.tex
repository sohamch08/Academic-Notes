% !TEX program = xelatex
\documentclass[aspectratio=1610]{beamer}
\usepackage[T1]{fontenc}
\usetheme{wildcat}
\usepackage{xcolor, mathtools, optidef}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing, arrows.meta, shapes, calc, positioning}
\DeclareMathOperator{\poa}{\mathsf{PoA}}
\input{../letterfonts}
\input{macros}
\title{Bounding $\poa$ using LP, QP and Fenchel Duality}
\date{April 2025}
\author{Soham Chatterjee}

% You change the titlegraphic to whatever you want, or comment it out to remove it.
% \titlegraphic{\includegraphics[scale=0.25]{logo-northwestern.pdf}}

% % You can directly change the colors using the following macros.
% % You must redefine colors AFTER the theme is loaded.
% % For example, these provide shades of Yale Blue (#00356b)
% \definecolor{wcprimary}{RGB}{0,53,107}      % Main color
% \definecolor{wcprimary140}{RGB}{0, 34, 70}
% \definecolor{wcprimary130}{RGB}{0, 40, 80}
% \definecolor{wcprimary120}{RGB}{0, 45, 91}
% \definecolor{wcprimary110}{RGB}{0, 50, 102}
% \definecolor{wcprimary40}{RGB}{153, 174, 196}
% \definecolor{wcprimary30}{RGB}{179, 194, 211}
% \definecolor{wcprimary20}{RGB}{204, 215, 225}
% \definecolor{wcprimary10}{RGB}{230, 235, 240}

% % Now for the alerted orange (#bd5319) and example green (#5f712d)
% \definecolor{wcalerted}{RGB}{189,83,25}
% \definecolor{wcexample}{RGB}{95,113,45}

% % If you want to change the slide background color, 
% % you can use the following command:
%\setbeamercolor{background canvas}{bg=nupurple10!30}

% % Turn off section slides
% \AtBeginSection{}

% Change the font theme
%\usefonttheme{wildcat-overleaf}

% Change the bg pattern manually: Simple Single Color
% \renewcommand{\bgpattern}{
%     \draw[color=wcprimary,fill=wcprimary] (0,0) rectangle (\paperwidth,\paperheight);
% }

\definecolor{doc}{HTML}{DCBCD0}
\definecolor{myg}{RGB}{56, 140, 70}
\definecolor{myb}{RGB}{45, 111, 177}
\definecolor{myr}{RGB}{199, 68, 64}
\definecolor{mybg}{HTML}{F2F2F9}
\definecolor{mytheorembg}{HTML}{F2F2F9}
\definecolor{mytheoremfr}{HTML}{00007B}
\definecolor{myexamplebg}{HTML}{F2FBF8}
\definecolor{myexamplefr}{HTML}{88D6D1}
\definecolor{myexampleti}{HTML}{2A7F7F}
\definecolor{mydefinitbg}{HTML}{E5E5FF}
\definecolor{mydefinitfr}{HTML}{3F3FA3}
\definecolor{notesgreen}{RGB}{0,162,0}
\definecolor{myp}{RGB}{197, 92, 212}
\definecolor{mygr}{HTML}{2C3338}
\definecolor{myred}{RGB}{127,0,0}
\definecolor{myyellow}{RGB}{169,121,69}
\definecolor{OrangeRed}{HTML}{ED135A}
\definecolor{Dandelion}{HTML}{FDBC42}
\definecolor{light-gray}{gray}{0.95}
\definecolor{Emerald}{HTML}{00A99D}
\definecolor{RoyalBlue}{HTML}{0071BC}
\definecolor{mytoccolor}{HTML}{886830}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

% \begin{frame}{Table of Contents}
%     \tableofcontents
% \end{frame}

\begin{frame}{Introduction}
    The Wildcat theme is a Beamer theme for Northwestern University, but which can be modified easily with different colors, fonts, and even background patterns. 
    \\ ~ \\
    The theme is inspired by the \href{https://github.com/matze/mtheme}{Metropolis theme} by Matthias Vogelgesang. It incorporates the Northwestern University facet design pattern, but otherwise has a clean, simple look, and relatively few bells and whistles. It is licensed under the GNU GENERAL PUBLIC LICENSE.
\end{frame}
\section{Weighted Congestion Games}
\begin{frame}
    \frametitle{Definitions}
    \begin{itemize}
        \item $\mcN$: Set of players
        \item $\mcE$: The ground set of resources
        \item For each player $j \in \mcN$, let $S_j\subseteq 2^{\mcE}$ be the set of strategies available to player $j$. Let $S=\bigtimes\limits_{j\in\mcN}S_i$.
        \item For each $j\in \mcN$ and each $e\in \mcE$ there is a weight of the resource $w_{ej}\in\bbR^+$.
        \item For each $e\in \mcE$ the cost of resource $e$ is an affine function $C_e:\bbR\to\bbR$ where $c_e(x)=a_e\cdot x+b_e$
        \item For any strategy profile $f\in S$, the cost of player $j$ is $\mathcolor{mytheoremfr}{\textbf{Cost}(f)_j=\sum\limits_{e\in f_j}w_{ej}\cdot c_e(l_e(f))}$ where $\mathcolor{mytheoremfr}{l_e(f)=\sum\limits_{j':e\in f_{j'}}w_{ej'}}$ is the load on resource $e$. Do $$\text{Cost}(f)=\sum_{j\in\mcN}\sum_{e\in f_j}w_{ej}\cdot c_e(l_e(f))=\sum_{e\in\mcE}a_e\cdot l_e(f)+b_e\cdot l_e(f)$$
    \end{itemize}
\end{frame}
\begin{frame}
\frametitle{Convex program of WCG}

\framesubtitle{Setting up the variables}
For any player $j\in\mcN$ and $f_j\in S_j$ let          \only<1>{
    \(
    \color{myr}{L\st_{j,f_j} = \sum\limits_{e \in f_j} w_{ej} \cdot c_e(w_{ej})}
    \)
}
% From slide 2 onwards: Normal weight and black
\only<2->{
    \(
    L_{j,f_j} = \sum\limits_{e \in f_j} w_{ej} \cdot c_e(w_{ej})
    \)
}i.e. the cost incurred by player $j$ when it plays strategy $f_j$.\pause

\begin{itemize}[itemsep=2em, topsep=2em]
    \item  \only<2>{$\mathcolor{myr}{\boldsymbol{x\st_{j,f_j}}}$} \only<3->{$x\st_{j,f_j}$} $\coloneqq$ Variable for player $j$ playing strategy $f_j$ for all $j\in\mcN$ and $f_j\in S_j$\pause

    \item {$\mathcolor{myr}{\boldsymbol{y_e}}$} $\coloneqq$ Variable for the load on resource $e$ for all $e\in\mcE$
\end{itemize}
\end{frame}

% \begin{frame}{Convex program of WCG}
%     \framesubtitle{Quadratic Program}  
% \begin{mini*}{}{\sum_{j\in\mcN}\sum_{f_j\in S_j}x\st_{j,f_j}\cdot L\st_{j,f_j}+\sum_{e\in\mcE}a_e\cdot y_e^2}{}{}
%     \addConstraint{\sum_{f_j\in S_j}x\st_{j,f_j}}{\leq 1}{\quad\forall\ j\in\mcN}
%     \addConstraint{\sum_{j\in\mcN}\sum_{f_j\in S_j}\sum_{e\in f_j}w_{ej}\cdot x\st_{j,f_j}}{\leq y_e}{\quad\forall \ e\in\mcE}
%     \addConstraint{x\st_{j,f_j}}{\geq 0}{\quad \forall\ j\in\mcN,\ f_j\in S_j}
% \end{mini*}
    
% \end{frame}

\begin{frame}{Convex program of WCG}
    \framesubtitle{Quadratic Program}  
    
    \visible<1->{\begin{mini*}{}{\sum_{j\in\mcN}\sum_{f_j\in S_j}x\st_{j,f_j}\cdot L\st_{j,f_j}+\sum_{e\in\mcE}a_e\cdot y_e^2}{}{}
        \addConstraint{\sum_{f_j\in S_j}x\st_{j,f_j}}{\leq 1}{\quad\forall\ j\in\mcN}
        \addConstraint{\sum_{j\in\mcN}\sum_{f_j\in S_j}\sum_{e\in f_j}w_{ej}\cdot x\st_{j,f_j}}{\leq y_e}{\quad\forall \ e\in\mcE}
        \addConstraint{x\st_{j,f_j}}{\geq 0}{\quad \forall\ j\in\mcN,\ f_j\in S_j}
    \end{mini*}}
    
    \only<2>{  \begin{tikzpicture}[remember picture, overlay]
        % Coordinates for the first constraint
        \coordinate (constraint) at ($(current page.center)+(2,0.2)$);
        
        % UPWARD-FACING curly brace under the first constraint
        \draw 
            ($(constraint)+(-2.6,-0.65)$) rectangle ($(constraint)+(1.5,+0.45)$);
            
        % Arrow start point (below the brace)
        \coordinate (arrowstart) at ($(constraint)+(0,-0.65)$);
        
       
            % Explanation box
            \node[draw, fill=doc, 
                  text width=10cm, align=left,line width=1pt, 
                  below left=1cm and -1.5cm of arrowstart] (explanation) {
                This constraint makes sure only one strategy is played by each player.
            };
            
            % Straight tapered arrow
            \fill[black, draw=black] 
                (arrowstart) -- 
                ($(explanation.north)-(0.2,0)$) -- 
                ($(explanation.north)+(0.2,0)$) -- 
                cycle;                
    \end{tikzpicture}}  
    \only<3>{  \begin{tikzpicture}[remember picture, overlay]
        % Coordinates for the first constraint
        \coordinate (constraint) at ($(current page.center)+(2,0.2)$);
        
        % UPWARD-FACING curly brace under the first constraint
        \draw 
            ($(constraint)+(-4.65,-1.85)$) rectangle ($(constraint)+(1.5,-0.65)$);
            
        % Arrow start point (below the brace)
        \coordinate (arrowstart) at ($(constraint)+(-2.5,-1.85)$);
        
       
            % Explanation box
            \node[draw, fill=doc, 
                  text width=11cm, align=left,line width=1pt, 
                  below left=1cm and -5cm of arrowstart] (explanation) {
                This constraint makes sure that the load on each resource is at least sum of the weights of the players using that resource.
            };
            
            % Straight tapered arrow
            \fill[black, draw=black] 
                (arrowstart) -- 
                ($(explanation.north)+(0.2,0)$) -- 
                ($(explanation.north)+(0.4,0)$) -- 
                cycle;                
    \end{tikzpicture}}
\end{frame}

\begin{frame}{Dual Program}
We denote the dual variables by $\{\mu_j\}_{j\in\mcN}$, $\{\Phi_e\}_{e\in\mcE}$ and $\{\Psi_e\}_{e\in\mcE}$. Then we use the Fenchel Duality to obtain the dual  of the convex program.
\only<1>{\begin{maxi*}{}{\sum_{j\in\mcN}\mu_j-\sum_{e\in\mcE} \frac1{4a_e}\cdot \Phi_e^2}{}{}
    \addConstraint{\mu_j-\sum\limits_{e\in f_j}w_{e,j}\cdot \Psi_e}{\leq L\st_{j,f_j}}{\quad\forall\ j\in\mcN,f_j\in S_j}
    \addConstraint{\Psi_e}{\leq\Phi_e}{\quad\forall\ e\in\mcE}
    \addConstraint{\mu_j}{\geq 0}{\quad\forall\ j\in\mcN}
    \addConstraint{\Phi_e}{\geq 0}{\quad\forall\ e\in\mcE}
\end{maxi*}}

\only<2>{\begin{maxi*}{}{\sum_{j\in\mcN}\mu_j-\sum_{e\in\mcE} \frac1{4a_e}\cdot \Phi_e^2}{}{}
    \addConstraint{\mu_j-\sum\limits_{e\in f_j}w_{e,j}\cdot \Phi_e}{\leq L\st_{j,f_j}}{\quad\forall\ j\in\mcN,f_j\in S_j}
    \addConstraint{\mu_j}{\geq 0}{\quad\forall\ j\in\mcN}
    \addConstraint{\Phi_e}{\geq 0}{\quad\forall\ e\in\mcE}
\end{maxi*}}\pause

\begin{tblock}{Remark}
    We can take $\Phi_e=\Psi_e$ for all $e\in \mcE$ as from every \textsf{CCE} we will assign $\Phi_e$ and $\Psi_e$ to be the same value
\end{tblock}


\end{frame}

\begin{frame}{$\left(1+\frac1\dl\right)$-Approximate Solution from Primal}

    Consider the following changed primal program:
    \begin{mini*}{}{\mathcolor{myr}{\boldsymbol{\frac1{\dl}}}\sum_{j\in\mcN}\sum_{f_j\in S_j}x\st_{j,f_j}\cdot L\st_{j,f_j}+\sum_{e\in\mcE}a_e\cdot y_e^2}{}{}
    \addConstraint{\sum_{f_j\in S_j}x\st_{j,f_j}}{\leq 1}{\quad\forall\ j\in\mcN}
    \addConstraint{\sum_{j\in\mcN}\sum_{f_j\in S_j}\sum_{e\in f_j}w_{ej}\cdot x\st_{j,f_j}}{\leq y_e}{\quad\forall \ e\in\mcE}
    \addConstraint{x\st_{j,f_j}}{\geq 0}{\quad \forall\ j\in\mcN,\ f_j\in S_j}
\end{mini*}

If $\dl=1$ we get our original program. For any $\dl>0$ we get a $\lt(1+\frac1{\dl}\rt)$-approximate solution.
\end{frame}

\begin{frame}{Dual don't need to change}
    Taking the dual of the new program we get the following:
    \begin{maxi*}{}{\sum_{j\in\mcN}\mu_j-\sum_{e\in\mcE} \frac1{4a_e}\cdot \Phi_e^2}{}{}
    \addConstraint{\mu_j-\sum\limits_{e\in f_j}w_{e,j}\cdot \mathcolor{myr}{\boldsymbol{\Phi_e}}}{\leq \mathcolor{myr}{\boldsymbol{\frac{L\st_{j,f_j}}{\dl}}}}{\quad\forall\ j\in\mcN,f_j\in S_j}
    \addConstraint{\mu_j}{\geq 0}{\quad\forall\ j\in\mcN}
    \addConstraint{\Phi_e}{\geq 0}{\quad\forall\ e\in\mcE}
    \end{maxi*}

So instead if we work with the old dual program and scale our variables $\mu_j$, $\Phi_e$ and $\Psi_e$ by $\frac1{\dl}$ we still get a feasible solution to the new dual program.
\end{frame}
\begin{frame}{Setting the Dual Variables}
    Let $\sg$ is any \textsf{CCE} of the  game. Set
    \begin{itemize}
        \item $\mu_j=\dfrac1{\dl}\cdot\underset{f\sim \sg}{\bbE}[\text{Cost}_j(f)]$
        \item $\Phi_e=\dfrac1{\dl}\cdot a_e\cdot \underset{f\sim \sg}{\bbE}[l_e(f)]$
    \end{itemize}\pause

    \begin{align*}
        \text{Cost}_j(f_j,\theta_{-j}) & \leq \sum_{e\in f_j}w_{e,j}\cdot (a_e(l_e(\theta)+w_{e,j})+b_e)\\
        & = \sum_{e\in f_j}w_{e,j}(a_e\cdot w_{e,j}+b_e)+\sum_{e\in f_j}w_{e,j}\cdot a_e\cdot l_e(\theta)\\
        & = L\st_{j,f_j}+\sum_{e\in f_j}w_{e,j}\cdot a_e\cdot l_e(\theta)
    \end{align*}
\end{frame}

\begin{frame}{Bound on \textsf{PoA} : I}
    \vspace*{-8mm}
    \begin{align*}
        \sum_{e\in \mcE} \frac1{ a_e}\cdot a_e^2\cdot \underset{f\sim \sg}{\bbE}[l_e(f)]^2 & = \sum_{e\in \mcE}  a_e\cdot\underset{f\sim \sg}{\bbE}[l_e(f)]^2 \\
        & \leq \underset{f\sim \sg}{\bbE}\lt[ \sum_{e\in\mcN} a_e\cdot l_e^2(f)  \rt]& [\text{Jensen}]\\
        & \leq \underset{f\sim \sg}{\bbE}\lt[ \sum_{e\in\mcN} \text{Cost}_j(f)\rt] =\sum_{j\in\mcN}\underset{f\sim \sg}{\bbE}[\text{Cost}_j(f)]
    \end{align*}
\end{frame}
\begin{frame}{Bound on \textsf{PoA} : II}
    \begin{align*}
        \text{Primal-Sol} & \geq \sum\limits_{j\in \mcN}\frac1{\dl}\cdot \underset{f\sim \sg}{\bbE}[\text{Cost}_j(f)]-\sum_{e\in \mcE}\frac1{\dl^2}\cdot \frac1{4}a_e\cdot \underset{f\sim \sg}{\bbE}[l_e(f)]^2\\
        & \geq  \frac{1}{\dl}\sum_{j\in\mcN}\underset{f\sim \sg}{\bbE}[\text{Cost}_j(f)]-\frac1{4\cdot \dl^2}\cdot \sum_{e\in \mcE}\underset{f\sim \sg}{\bbE}[\text{Cost}_j(f)]\\
        & = \frac{4\dl-1}{4\dl^2}\sum_{e\in \mcE}\underset{f\sim \sg}{\bbE}[\text{Cost}_j(f)]
    \end{align*}\pause

Primal is $\lt(1+\frac1{\dl}\rt)$-approximate solution to the optimal solution. So we get a bound of $\mathcolor{myr}{\lt(1+\frac1{\dl}\rt)\dfrac{4\dl^2}{4\dl-1}}$ bound on $\textsf{PoA}$.  Take $\dl=\frac{1+\sqrt{5}}{4}$ you will get a bound of $\mathcolor{myr}{1+\Phi}$ where $\Phi$ is the golden ratio.
\end{frame}

\section{Simultaneous Second-Price Auctions}






\standout{Questions?}


\end{document}